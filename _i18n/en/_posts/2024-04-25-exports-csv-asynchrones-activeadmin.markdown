---
layout: article
title:  "Scalable and Efficient Data Exports: Enabling ActiveAdmin's Asynchronous Mode"
date:   2024-04-25 21:37:00 +0200
categories: Rails ActiveAdmin
---
Data export is a essential feature in many modern web applications.
In ActiveAdmin, CSV exports are synchronously generated by default.
However, when the exported data sets are large, this approach can lead
to prolonged blocking of HTTP connections, negatively affecting
the overall performance of the application.

When a connection stays busy for too long, it can exhaust
the server's resources, causing delays for other users.
If this situation persists and resources are completely depleted,
other users' requests will be blocked, rendering the application inaccessible.

To address this problem, the gem `activeadmin-async_exporter` was initially
developed to enable asynchronous export generation through ActiveJob. However,
we encountered several issues with this solution. First,
the `activeadmin-async_exporter` gem is no longer maintained
and is incompatible with the latest versions of Rails.

While trying to install it, we ran into a `NameError`,,
which seemed to be related to autoloading issues. Additionally, the configuration
of `strong parameters` is not considered, and the gem uses
the `current_admin_user` method, whereas our application uses `current_user`.

Although ActiveAdmin allows configuring these aspects,
the `activeadmin-async_exporter` gem does not suppport these configurations.

Moreover, the gem does not support ActiveStorage and uses a different file storage system.

Although the gem provides a code generator for setting up a database migration
and an ActiveAdmin resource, its use is not documented in the README.
The README only mentions adding the gem to the Gemfile
without providing detailed instructions.

Given these limitations, we decided to integrate the code from
the `activeadmin-async_exporter` gem into our application,
customizing it to meet our specific needs.

We have not published the gem yet as our current efforts are focused
on other aspects of our project. Although the current code meets our
internal requirements, we have not planned to invest additional time
adapting it for potential public release. Thus, we prefer to leave
it as is for now, without completely ruling out the possibility
of future publication.

Extracting the code posed some technical challenges.
Specifically, out worker needed to inherit from ApplicationJob,
requiring us to place the code in the `app/workers` directory.
Additionally, some aspects of the code had to be modified
to ensure compatibility with our application.

Despite these difficulties, using asynchronous exports in ActiveAdmin
has proven crucial in improving the performance of our application.
By adapting the existing gem to fit our specific needs, we were able
to leverage this technology while maintaining complete control
over its functionality.

Through this process, we were able to significantly enhance the scalability
and efficiency of our system, while simultaneously providing
a smoother and more responsive experience for our users.
